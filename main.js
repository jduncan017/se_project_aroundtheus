!function(){"use strict";var e="";const t={formSelector:".popup__form",inputSelector:".popup__form-input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"popup__input-invalid",errorClass:"popup__error_visible"};class s{constructor(e,t,s,r,i,n,o){let{name:a,link:c,owner:u,_id:l,likes:d}=e;this._text=a,this._imageLink=c,this._ownerId=u._id,this._cardId=l,this._cardLikesArray=d,this._userId=t,this._newCard=s.cloneNode(!0),this._cardImage=this._newCard.querySelector(".card__image"),this._cardTitle=this._newCard.querySelector(".card__title"),this._cardLikesCounter=this._newCard.querySelector(".card__likes-counter"),this._placeholderImage=r,this._handleCardClick=i,this._handleTrashClick=n,this._cardLikeBtn=this._newCard.querySelector(".card__like-button"),this._cardTrashBtn=this._newCard.querySelector(".card__trash-button"),this._cardSelector=this._cardTrashBtn.parentElement,this._handleLikeClick=o}getId(){return this._cardId}setLikes(e){this._cardLikesArray=e,this._renderLikes()}isLiked(){return this._cardLikesArray.some((e=>e._id===this._userId))}createCard(){return this._cardImage.src=this._imageLink,this._cardImage.onerror=()=>{this._cardImage.src=this._placeholderImage},this._cardImage.alt=this._text,this._cardTitle.textContent=this._text,this._newCard.id=this._cardId,this._setInitialState(),this._newCard}_addListeners(){this._cardLikeBtn.addEventListener("click",(()=>{this._cardLikeBtn.classList.toggle("card__like-button_active"),this._handleLikeClick(this)})),this._cardTrashBtn.addEventListener("click",(()=>this._handleTrashClick(this))),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._cardImage.src,this._text)}))}_setInitialState(){this._addListeners(),this._ownerId!==this._userId&&this._cardTrashBtn.remove(),this._renderLikes()}_renderLikes(){this._cardLikesCounter.textContent=this._cardLikesArray.length,this.isLiked()?this._cardLikeBtn.classList.add("card__like-button_active"):this._cardLikeBtn.classList.remove("card__like-button_active")}}class r{constructor(e,t){this.settings=e,this.formElement=t,this.button=t.querySelector(this.settings.submitButtonSelector),this.inputElements=Array.from(t.querySelectorAll(this.settings.inputSelector))}_setEventListeners(){this._toggleButtonState(),this.inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputErrorDisplay(this.formElement,e),this._toggleButtonState(this.inputElements)}))}))}_checkInputValidity(e){return e.validity.valid}_checkFormValidity(e){return e.every((e=>this._checkInputValidity(e)))}_hideError(e,t){t.classList.remove(this.settings.errorClass),e.classList.remove(this.settings.inputErrorClass)}_showError(e,t){t.classList.add(this.settings.errorClass),e.classList.add(this.settings.inputErrorClass)}_toggleInputErrorDisplay(e,t){const s=e.querySelector(`#${t.id}-error`);s.textContent=t.validationMessage,this._checkInputValidity(t)?this._hideError(t,s):this._showError(t,s)}_enableButton(e){e.classList.remove(this.settings.inactiveButtonClass),e.disabled=!1}_disableButton(e){e.classList.add(this.settings.inactiveButtonClass),e.disabled=!0}_toggleButtonState(){this._checkFormValidity(this.inputElements)?this._enableButton(this.button):this._disableButton(this.button)}resetValidation(){this._toggleButtonState(),this.inputElements.forEach((e=>{const t=this.formElement.querySelector(`#${e.id}-error`);this._hideError(e,t)}))}enableValidation(){this._setEventListeners()}}class i{constructor(e,t){let{items:s,renderer:r}=e;this.items=s,this.renderer=r,this.container=document.querySelector(t)}renderItems(){this.items.forEach((e=>{this.appendItem(this.renderer(e))}))}appendItem(e){this.container.append(e)}prependItem(e){this.container.prepend(e)}}class n{constructor(e){this.popup=document.querySelector(e),this.closeButton=this.popup.querySelector(".popup__close-button"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this.popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this.popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this.closeButton.addEventListener("click",(e=>{e.stopPropagation(),this.close()})),this.popup.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}_handleEscClose(e){"Escape"===e.key&&this.close()}}class o extends n{constructor(e,t){super(e),this._popupForm=this.popup.querySelector(".popup__form"),this._handleFormSubmit=t,this._inputList=Array.from(this._popupForm.querySelectorAll("input"))}_getInputValues(){const e=Array.from(this._popupForm.elements),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.stopPropagation(),e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._popupForm.reset()}}var a=e+"4d1dba3d8f0a3d9f693e.png";const c={};let u=null,l=null;function d(e,t){e.textContent=t}const h=document.querySelector("#cards").content.firstElementChild;function p(e){return new s(e,l,h,a,w,E,A).createCard()}Array.from(document.querySelectorAll(t.formSelector)).forEach((e=>{const s=new r(t,e),i=e.getAttribute("name");c[i]=s,s.enableValidation()}));const _=new class{constructor(e){let{userNameSelector:t,userAboutSelector:s,userPictureSelector:r}=e;this.userNameElement=document.querySelector(t),this.userAboutElement=document.querySelector(s),this.userPictureElement=document.querySelector(r)}getUserInfo(){return{name:this.userNameElement.textContent,about:this.userAboutElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this.userNameElement.textContent=t,this.userAboutElement.textContent=s}setUserPicture(e){let{avatar:t}=e;this.userPictureElement.src=t}}({userNameSelector:".profile__name-title",userAboutSelector:".profile__about",userPictureSelector:".profile__picture"}),m=new class{constructor(e){this._url=e.url,this._headers=e.headers}getUserInfo(){return this._fetch("/users/me")}updateUserInfo(e){return this._fetch("/users/me","PATCH",e)}getInitialCards(){return this._fetch("/cards")}addCard(e){return this._fetch("/cards","POST",e)}deleteCard(e){return this._fetch(`/cards/${e}`,"DELETE")}likeCard(e){return this._fetch(`/cards/likes/${e}`,"PUT")}unlikeCard(e){return this._fetch(`/cards/likes/${e}`,"DELETE")}updateUserPicture(e){return this._fetch("/users/me/avatar","PATCH",e).then((e=>{document.querySelector(".profile__picture").src=e.avatar}))}_fetch(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s={method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",headers:this._headers};return t&&(s.body=JSON.stringify(t)),fetch(`${this._url}${e}`,s).then(this._checkResponse).catch((e=>console.error(e)))}_checkResponse(e){return e.ok?e.json():Promise.reject(`Oops there's an error!: ${e.status}`)}}({url:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"c1d3050f-9f71-48b4-9235-936056aa4e95","Content-Type":"application/json"}});Promise.all([m.getUserInfo(),m.getInitialCards()]).then((e=>{let[t,s]=e;_.setUserPicture({avatar:t.avatar}),_.setUserInfo({name:t.name,about:t.about}),l=t._id,u=new i({items:s,renderer:p},".cards__list"),u.renderItems()})).catch((e=>{console.error(`Error: ${e}`)}));const f=document.querySelector("#confirm-delete-button");function E(e){g.open(),g.setAction((()=>(d(f,"Deleting..."),m.deleteCard(e.getId()).then((()=>{document.getElementById(e.getId()).remove(),g.close()})).catch((e=>{console.error(`Error: ${e}`)})).finally((()=>{d(f,"Yes")})),f)))}const g=new class extends n{constructor(e){super(e),this._confirmButton=this.popup.querySelector(".confirm-popup__submit-button")}setAction(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}("#confirm-delete-popup");g.setEventListeners();const v=document.querySelector("#picture-submit-button"),k=document.querySelector(".profile__picture-overlay"),L=new o("#edit-profile-picture-popup",(function(e){d(v,"Saving..."),m.updateUserPicture({avatar:e.link}).then((()=>{L.close()})).catch((e=>{console.error(`Error: ${e}`)})).finally((()=>{d(v,"Save")}))}));L.setEventListeners(),k.addEventListener("click",(function(){c["edit-profile-picture-form"].resetValidation(),L.open()}));const S=document.querySelector("#profile-submit-button"),b=document.querySelector(".profile__name-button"),y=new o("#edit-popup",(function(e){d(S,"Saving..."),m.updateUserInfo({name:e.name,about:e.about}).then((e=>{_.setUserInfo({name:e.name,about:e.about}),y.close()})).catch((e=>{console.error(`Error: ${e}`)})).finally((()=>{d(S,"Save")}))}));y.setEventListeners(),b.addEventListener("click",(function(){c["edit-profile-form"].resetValidation();const e=_.getUserInfo();y.setInputValues(e),y.open()}));const C=document.querySelector(".profile__add-button"),I=document.querySelector("#image-submit-button"),q=new o("#add-image-popup",(function(e){d(I,"Saving..."),m.addCard({name:e.name,link:e.link}).then((e=>{const t=p(e);u.prependItem(t),q.close()})).catch((e=>{console.error(e)})).finally((()=>{d(I,"Save")}))}));q.setEventListeners(),C.addEventListener("click",(()=>{c["add-image-form"].resetValidation(),q.open()}));const B=new class extends n{constructor(e){super(e),this.popupImage=this.popup.querySelector(".image-popup__image"),this.imagePopupTitle=this.popup.querySelector(".image-popup__title")}open(e,t){this.popupImage.src=e,this.popupImage.alt=t,this.imagePopupTitle.textContent=t,super.open()}}("#image-popup");function w(e,t){B.open(e,t)}function A(e){const t=e.isLiked()?"unlikeCard":"likeCard";m[t](e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.error(`Error: ${e}`)}))}B.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFBU0EsSUFBUSxHQUV0QyxDQW5CQThCLEVBQVcxRyxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmRfdGhlX3VzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy8uL3NyYy9mYXZpY29uLmljbyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2Zvcm0taW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zdWJtaXQtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1pbnZhbGlkXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgbmFtZSwgbGluaywgb3duZXIsIF9pZCwgbGlrZXMgfSxcbiAgICB1c2VySWQsXG4gICAgdGVtcGxhdGVFbGVtZW50LFxuICAgIHBsYWNlaG9sZGVySW1hZ2UsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZVRyYXNoQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX3RleHQgPSBuYW1lO1xuICAgIHRoaXMuX2ltYWdlTGluayA9IGxpbms7XG4gICAgdGhpcy5fb3duZXJJZCA9IG93bmVyLl9pZDtcbiAgICB0aGlzLl9jYXJkSWQgPSBfaWQ7XG4gICAgdGhpcy5fY2FyZExpa2VzQXJyYXkgPSBsaWtlcztcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5fbmV3Q2FyZCA9IHRlbXBsYXRlRWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkTGlrZXNDb3VudGVyID0gdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9fbGlrZXMtY291bnRlclwiXG4gICAgKTtcbiAgICB0aGlzLl9wbGFjZWhvbGRlckltYWdlID0gcGxhY2Vob2xkZXJJbWFnZTtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayA9IGhhbmRsZVRyYXNoQ2xpY2s7XG4gICAgdGhpcy5fY2FyZExpa2VCdG4gPSB0aGlzLl9uZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZFRyYXNoQnRuID0gdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSB0aGlzLl9jYXJkVHJhc2hCdG4ucGFyZW50RWxlbWVudDtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cblxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgLyogICAgICAgICAgICAgUFVCTElDIE1FVEhPRFMgICAgICAgICAgICAgICovXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4gIGdldElkKCkge1xuICAgIHJldHVybiB0aGlzLl9jYXJkSWQ7XG4gIH1cblxuICBzZXRMaWtlcyhsaWtlcykge1xuICAgIHRoaXMuX2NhcmRMaWtlc0FycmF5ID0gbGlrZXM7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRMaWtlc0FycmF5LnNvbWUoKHVzZXIpID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VySWQpO1xuICB9XG5cbiAgY3JlYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5faW1hZ2VMaW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5vbmVycm9yID0gKCkgPT4ge1xuICAgICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX3BsYWNlaG9sZGVySW1hZ2U7XG4gICAgfTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fdGV4dDtcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xuICAgIHRoaXMuX25ld0NhcmQuaWQgPSB0aGlzLl9jYXJkSWQ7XG5cbiAgICB0aGlzLl9zZXRJbml0aWFsU3RhdGUoKTtcblxuICAgIHJldHVybiB0aGlzLl9uZXdDYXJkO1xuICB9XG5cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4gIC8qICAgICAgICAgICAgIFBSSVZBVEUgTUVUSE9EUyAgICAgICAgICAgICAqL1xuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuICBfYWRkTGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZFRyYXNoQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayh0aGlzKVxuICAgICk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9jYXJkSW1hZ2Uuc3JjLCB0aGlzLl90ZXh0KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9zZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgdGhpcy5fYWRkTGlzdGVuZXJzKCk7XG5cbiAgICBpZiAoISh0aGlzLl9vd25lcklkID09PSB0aGlzLl91c2VySWQpKSB7XG4gICAgICB0aGlzLl9jYXJkVHJhc2hCdG4ucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpIHtcbiAgICB0aGlzLl9jYXJkTGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fY2FyZExpa2VzQXJyYXkubGVuZ3RoO1xuXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuYnV0dG9uID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLmlucHV0RWxlbWVudHMgPSBBcnJheS5mcm9tKFxuICAgICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNldHRpbmdzLmlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuaW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvckRpc3BsYXkodGhpcy5mb3JtRWxlbWVudCwgaW5wdXQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLmlucHV0RWxlbWVudHMpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XG4gICAgcmV0dXJuIGlucHV0LnZhbGlkaXR5LnZhbGlkO1xuICB9XG5cbiAgX2NoZWNrRm9ybVZhbGlkaXR5KGlucHV0RWxlbWVudHMpIHtcbiAgICByZXR1cm4gaW5wdXRFbGVtZW50cy5ldmVyeSgoaW5wdXQpID0+IHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkpO1xuICB9XG5cbiAgX2hpZGVFcnJvcihpbnB1dCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgZXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9zaG93RXJyb3IoaW5wdXQsIGVycm9yTWVzc2FnZSkge1xuICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QuYWRkKHRoaXMuc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLnNldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlSW5wdXRFcnJvckRpc3BsYXkoZm9ybSwgaW5wdXQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIGVycm9yTWVzc2FnZS50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGlmICh0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpKSB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXQsIGVycm9yTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3Nob3dFcnJvcihpbnB1dCwgZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKGJ1dHRvbikge1xuICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfZGlzYWJsZUJ1dHRvbihidXR0b24pIHtcbiAgICBidXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLnNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2NoZWNrRm9ybVZhbGlkaXR5KHRoaXMuaW5wdXRFbGVtZW50cykpIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbih0aGlzLmJ1dHRvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24odGhpcy5idXR0b24pO1xuICAgIH1cbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuaW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgICApO1xuICAgICAgdGhpcy5faGlkZUVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLmFwcGVuZEl0ZW0odGhpcy5yZW5kZXJlcihpdGVtKSk7XG4gICAgfSk7XG4gIH1cblxuICBhcHBlbmRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XG4gIH1cblxuICBwcmVwZW5kSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5jbG9zZUJ1dHRvbiA9IHRoaXMucG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICAvKiAgICAgICAgICAgICBQVUJMSUMgTUVUSE9EUyAgICAgICAgICAgICAgKi9cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLnBvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgdGhpcy5wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gZXZlbnQuY3VycmVudFRhcmdldCkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgLyogICAgICAgICAgICAgUFJJVkFURSBNRVRIT0RTICAgICAgICAgICAgICovXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMucG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIikpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20odGhpcy5fcG9wdXBGb3JtLmVsZW1lbnRzKTtcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB2YWx1ZXM7XG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgfSk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCJmYXZpY29uLmljb1wiOyIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgIElNUE9SVFMgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmltcG9ydCB1c2VyQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFBvcHVwQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBcIi4uL2Zhdmljb24uaWNvXCI7XG5pbXBvcnQgcGxhY2Vob2xkZXJJbWFnZSBmcm9tIFwiLi4vaW1hZ2VzL05vLUltYWdlLVBsYWNlaG9sZGVyLnBuZ1wiO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICBGSUxFIFZBUklBQkxFIERFRklOSVRJT05TICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG5sZXQgY2FyZHNTZWN0aW9uID0gbnVsbDtcbmxldCB1c2VySWQgPSBudWxsO1xuXG5mdW5jdGlvbiByZW5kZXJMb2FkaW5nKGJ1dHRvbiwgbWVzc2FnZSkge1xuICBidXR0b24udGV4dENvbnRlbnQgPSBtZXNzYWdlO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICBJTklUSUFMIFJFTkRFUklORyAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vLyB2YXJpYWJsZSBkZWZpbml0aW9uc1xuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZHNcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcbmNvbnN0IGZvcm1FbGVtZW50cyA9IEFycmF5LmZyb20oXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKVxuKTtcblxuLy8gYWRkIHZhbGlkYXRpb24gdG8gYWxsIGZvcm1zXG5mb3JtRWxlbWVudHMuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcbiAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xuICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG59KTtcblxuLy8gRlVOQ1RJT05TXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICB1c2VySWQsXG4gICAgY2FyZFRlbXBsYXRlLFxuICAgIHBsYWNlaG9sZGVySW1hZ2UsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZVRyYXNoQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICk7XG4gIHJldHVybiBjYXJkLmNyZWF0ZUNhcmQoKTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgRkVUQ0ggU0lURSBEQVRBICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLy8gVmFyaWFibGVzOlxuY29uc3QgdXNlckluZm9TZWxlY3RvciA9IHtcbiAgdXNlck5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZS10aXRsZVwiLFxuICB1c2VyQWJvdXRTZWxlY3RvcjogXCIucHJvZmlsZV9fYWJvdXRcIixcbiAgdXNlclBpY3R1cmVTZWxlY3RvcjogXCIucHJvZmlsZV9fcGljdHVyZVwiLFxufTtcblxuLy8gQ3JlYXRlIENsYXNzZXM6XG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh1c2VySW5mb1NlbGVjdG9yKTtcbmNvbnN0IGFwaSA9IG5ldyB1c2VyQXBpKHtcbiAgdXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiYzFkMzA1MGYtOWY3MS00OGI0LTkyMzUtOTM2MDU2YWE0ZTk1XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNBcnJheV0pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VyUGljdHVyZSh7IGF2YXRhcjogdXNlckRhdGEuYXZhdGFyIH0pO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICBhYm91dDogdXNlckRhdGEuYWJvdXQsXG4gICAgfSk7XG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xuXG4gICAgY2FyZHNTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgICB7IGl0ZW1zOiBpbml0aWFsQ2FyZHNBcnJheSwgcmVuZGVyZXI6IHJlbmRlckNhcmQgfSxcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcbiAgICApO1xuICAgIGNhcmRzU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihgRXJyb3I6ICR7ZXJyb3J9YCk7XG4gIH0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgQ09ORklSTSBERUxFVEUgUE9QVVAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vLyBWYXJpYWJsZXM6XG5jb25zdCBjb25maXJtRGVsZXRlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb25maXJtLWRlbGV0ZS1idXR0b25cIik7XG5cbmZ1bmN0aW9uIGhhbmRsZVRyYXNoQ2xpY2soY2FyZEluc3RhbmNlKSB7XG4gIGNvbmZpcm1EZWxldGVQb3B1cC5vcGVuKCk7XG4gIGNvbmZpcm1EZWxldGVQb3B1cC5zZXRBY3Rpb24oKCkgPT4ge1xuICAgIHJlbmRlckxvYWRpbmcoY29uZmlybURlbGV0ZUJ0biwgXCJEZWxldGluZy4uLlwiKTtcbiAgICByZXR1cm4gKFxuICAgICAgYXBpXG4gICAgICAgIC5kZWxldGVDYXJkKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYXJkSW5zdGFuY2UuZ2V0SWQoKSk7XG4gICAgICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgY29uZmlybURlbGV0ZVBvcHVwLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogJHtlcnJvcn1gKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgIHJlbmRlckxvYWRpbmcoY29uZmlybURlbGV0ZUJ0biwgXCJZZXNcIik7XG4gICAgICAgIH0pLFxuICAgICAgY29uZmlybURlbGV0ZUJ0blxuICAgICk7XG4gIH0pO1xufVxuXG4vLyBDcmVhdGUgUG9wdXA6XG5jb25zdCBjb25maXJtRGVsZXRlUG9wdXAgPSBuZXcgUG9wdXBDb25maXJtKFwiI2NvbmZpcm0tZGVsZXRlLXBvcHVwXCIpO1xuY29uZmlybURlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgIFBST0ZJTEUgUElDVFVSRSBFRElUIEZPUk0gICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vLyBWYXJpYWJsZXM6XG5jb25zdCBwaWN0dXJlU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaWN0dXJlLXN1Ym1pdC1idXR0b25cIik7XG5jb25zdCBlZGl0UHJvZmlsZVBpY3R1cmVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19waWN0dXJlLW92ZXJsYXlcIlxuKTtcblxuLy8gQ3JlYXRlIFBvcHVwOlxuY29uc3QgZWRpdFByb2ZpbGVQaWN0dXJlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNlZGl0LXByb2ZpbGUtcGljdHVyZS1wb3B1cFwiLFxuICBoYW5kbGVQaWN0dXJlRm9ybVN1Ym1pdFxuKTtcbmVkaXRQcm9maWxlUGljdHVyZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gRnVuY3Rpb25hbGl0eSBmb3IgdGhlIHByb2ZpbGUgcGljdHVyZSBidXR0b25cbmVkaXRQcm9maWxlUGljdHVyZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBmb3JtVmFsaWRhdG9yc1tcImVkaXQtcHJvZmlsZS1waWN0dXJlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGVkaXRQcm9maWxlUGljdHVyZUZvcm0ub3BlbigpO1xufSk7XG5cbi8vIEhhbmRsZSBGb3JtIFN1Ym1pc3Npb246XG5mdW5jdGlvbiBoYW5kbGVQaWN0dXJlRm9ybVN1Ym1pdChpbnB1dHMpIHtcbiAgcmVuZGVyTG9hZGluZyhwaWN0dXJlU3VibWl0QnRuLCBcIlNhdmluZy4uLlwiKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJQaWN0dXJlKHsgYXZhdGFyOiBpbnB1dHMubGluayB9KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGVkaXRQcm9maWxlUGljdHVyZUZvcm0uY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yOiAke2Vycm9yfWApO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcmVuZGVyTG9hZGluZyhwaWN0dXJlU3VibWl0QnRuLCBcIlNhdmVcIik7XG4gICAgfSk7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgIFBST0ZJTEUgRURJVCBGT1JNICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8vIFZhcmlhYmxlczpcbmNvbnN0IHByb2ZpbGVGb3JtU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXN1Ym1pdC1idXR0b25cIik7XG5jb25zdCBlZGl0UHJvZmlsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZS1idXR0b25cIik7XG5cbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNlZGl0LXBvcHVwXCIsXG4gIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0XG4pO1xuZWRpdFByb2ZpbGVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIEVkaXQgQnV0dG9uIEZ1bmN0aW9uYWxpdHk6XG5lZGl0UHJvZmlsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBmb3JtVmFsaWRhdG9yc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBjb25zdCBkYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgZWRpdFByb2ZpbGVGb3JtLnNldElucHV0VmFsdWVzKGRhdGEpO1xuICBlZGl0UHJvZmlsZUZvcm0ub3BlbigpO1xufSk7XG5cbi8vIEhhbmRsZSBGb3JtIFN1Ym1pc3Npb246XG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChpbnB1dHMpIHtcbiAgcmVuZGVyTG9hZGluZyhwcm9maWxlRm9ybVN1Ym1pdEJ0biwgXCJTYXZpbmcuLi5cIik7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyh7IG5hbWU6IGlucHV0cy5uYW1lLCBhYm91dDogaW5wdXRzLmFib3V0IH0pXG4gICAgLnRoZW4oKG5ld1VzZXJEYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgIG5hbWU6IG5ld1VzZXJEYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiBuZXdVc2VyRGF0YS5hYm91dCxcbiAgICAgIH0pO1xuICAgICAgZWRpdFByb2ZpbGVGb3JtLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogJHtlcnJvcn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHJlbmRlckxvYWRpbmcocHJvZmlsZUZvcm1TdWJtaXRCdG4sIFwiU2F2ZVwiKTtcbiAgICB9KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICBBREQgSU1BR0UgRk9STSAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLy8gVmFyaWFibGVzOlxuY29uc3QgYWRkSW1hZ2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5jb25zdCBpbWFnZUZvcm1TdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLXN1Ym1pdC1idXR0b25cIik7XG5cbi8vIENyZWF0ZSBQb3B1cDpcbmNvbnN0IGFkZEltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjYWRkLWltYWdlLXBvcHVwXCIsXG4gIGhhbmRsZUltYWdlRm9ybVN1Ym1pdFxuKTtcbmFkZEltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gQWRkIEJ1dHRvbiBGdW5jdGlvbmFsaXR5OlxuYWRkSW1hZ2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbXCJhZGQtaW1hZ2UtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgYWRkSW1hZ2VQb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gSGFuZGxlIEZvcm0gU3VibWlzc2lvbjpcbmZ1bmN0aW9uIGhhbmRsZUltYWdlRm9ybVN1Ym1pdChpbnB1dHMpIHtcbiAgcmVuZGVyTG9hZGluZyhpbWFnZUZvcm1TdWJtaXRCdG4sIFwiU2F2aW5nLi4uXCIpO1xuICBhcGlcbiAgICAuYWRkQ2FyZCh7IG5hbWU6IGlucHV0cy5uYW1lLCBsaW5rOiBpbnB1dHMubGluayB9KVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGNvbnN0IG5ld0NhcmQgPSByZW5kZXJDYXJkKHJlcyk7XG4gICAgICBjYXJkc1NlY3Rpb24ucHJlcGVuZEl0ZW0obmV3Q2FyZCk7XG4gICAgICBhZGRJbWFnZVBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHJlbmRlckxvYWRpbmcoaW1hZ2VGb3JtU3VibWl0QnRuLCBcIlNhdmVcIik7XG4gICAgfSk7XG59XG5cbi8vIENyZWF0ZSBQb3B1cDpcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtcG9wdXBcIik7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhpbWFnZUxpbmssIHRleHQpIHtcbiAgaW1hZ2VQb3B1cC5vcGVuKGltYWdlTGluaywgdGV4dCk7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgIExpa2UgQnV0dG9uIEZ1bmN0aW9uYWxpdHkgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XG4gIGNvbnN0IG1ldGhvZCA9IGNhcmQuaXNMaWtlZCgpID8gXCJ1bmxpa2VDYXJkXCIgOiBcImxpa2VDYXJkXCI7XG5cbiAgYXBpW21ldGhvZF0oY2FyZC5nZXRJZCgpKVxuICAgIC50aGVuKChyZXNDYXJkKSA9PiB7XG4gICAgICBjYXJkLnNldExpa2VzKHJlc0NhcmQubGlrZXMpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgfSk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgdXNlck5hbWVTZWxlY3RvciwgdXNlckFib3V0U2VsZWN0b3IsIHVzZXJQaWN0dXJlU2VsZWN0b3IgfSkge1xuICAgIHRoaXMudXNlck5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLnVzZXJBYm91dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBYm91dFNlbGVjdG9yKTtcbiAgICB0aGlzLnVzZXJQaWN0dXJlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlclBpY3R1cmVTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy51c2VyTmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy51c2VyQWJvdXRFbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLnVzZXJOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy51c2VyQWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gIH1cblxuICBzZXRVc2VyUGljdHVyZSh7IGF2YXRhciB9KSB7XG4gICAgdGhpcy51c2VyUGljdHVyZUVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyB1c2VyQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuX3VybCA9IG9wdGlvbnMudXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgLyogICAgICAgICAgICAgUFVCTElDIE1FVEhPRFMgICAgICAgICAgICAgICovXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLl9mZXRjaChcIi91c2Vycy9tZVwiKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJJbmZvKHVzZXJJbmZvKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZldGNoKFwiL3VzZXJzL21lXCIsIFwiUEFUQ0hcIiwgdXNlckluZm8pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiB0aGlzLl9mZXRjaChcIi9jYXJkc1wiKTtcbiAgfVxuXG4gIGFkZENhcmQoY2FyZEluZm8pIHtcbiAgICByZXR1cm4gdGhpcy5fZmV0Y2goXCIvY2FyZHNcIiwgXCJQT1NUXCIsIGNhcmRJbmZvKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZldGNoKGAvY2FyZHMvJHtjYXJkSWR9YCwgXCJERUxFVEVcIik7XG4gIH1cblxuICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fZmV0Y2goYC9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCBcIlBVVFwiKTtcbiAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZldGNoKGAvY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwgXCJERUxFVEVcIik7XG4gIH1cblxuICB1cGRhdGVVc2VyUGljdHVyZShhdmF0YXIpIHtcbiAgICByZXR1cm4gdGhpcy5fZmV0Y2goXCIvdXNlcnMvbWUvYXZhdGFyXCIsIFwiUEFUQ0hcIiwgYXZhdGFyKS50aGVuKChyZXMpID0+IHtcbiAgICAgIGNvbnN0IHByb2ZpbGVQaWN0dXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19waWN0dXJlXCIpO1xuICAgICAgcHJvZmlsZVBpY3R1cmUuc3JjID0gcmVzLmF2YXRhcjtcbiAgICB9KTtcbiAgfVxuXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICAvKiAgICAgICAgICAgICBQUklWQVRFIE1FVEhPRFMgICAgICAgICAgICAgKi9cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbiAgX2ZldGNoKGVuZHBvaW50LCBtZXRob2QgPSBcIkdFVFwiLCBib2R5ID0gbnVsbCkge1xuICAgIGNvbnN0IGZldGNoT3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZCxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfTtcblxuICAgIGlmIChib2R5KSB7XG4gICAgICBmZXRjaE9wdGlvbnMuYm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHkpO1xuICAgIH1cblxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9JHtlbmRwb2ludH1gLCBmZXRjaE9wdGlvbnMpXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihlcnJvcikpO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgT29wcyB0aGVyZSdzIGFuIGVycm9yITogJHtyZXMuc3RhdHVzfWApO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBDb25maXJtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IHRoaXMucG9wdXAucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNvbmZpcm0tcG9wdXBfX3N1Ym1pdC1idXR0b25cIlxuICAgICk7XG4gIH1cblxuICBzZXRBY3Rpb24oYWN0aW9uKSB7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGFjdGlvbjtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLnBvcHVwSW1hZ2UgPSB0aGlzLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtcG9wdXBfX2ltYWdlXCIpO1xuICAgIHRoaXMuaW1hZ2VQb3B1cFRpdGxlID0gdGhpcy5wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlLXBvcHVwX190aXRsZVwiKTtcbiAgfVxuICBvcGVuKGltYWdlTGluaywgdGV4dCkge1xuICAgIHRoaXMucG9wdXBJbWFnZS5zcmMgPSBpbWFnZUxpbms7XG4gICAgdGhpcy5wb3B1cEltYWdlLmFsdCA9IHRleHQ7XG4gICAgdGhpcy5pbWFnZVBvcHVwVGl0bGUudGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsInVzZXJJZCIsInRlbXBsYXRlRWxlbWVudCIsInBsYWNlaG9sZGVySW1hZ2UiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVUcmFzaENsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwibmFtZSIsImxpbmsiLCJvd25lciIsIl9pZCIsImxpa2VzIiwidGhpcyIsIl90ZXh0IiwiX2ltYWdlTGluayIsIl9vd25lcklkIiwiX2NhcmRJZCIsIl9jYXJkTGlrZXNBcnJheSIsIl91c2VySWQiLCJfbmV3Q2FyZCIsImNsb25lTm9kZSIsIl9jYXJkSW1hZ2UiLCJxdWVyeVNlbGVjdG9yIiwiX2NhcmRUaXRsZSIsIl9jYXJkTGlrZXNDb3VudGVyIiwiX3BsYWNlaG9sZGVySW1hZ2UiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZVRyYXNoQ2xpY2siLCJfY2FyZExpa2VCdG4iLCJfY2FyZFRyYXNoQnRuIiwiX2NhcmRTZWxlY3RvciIsInBhcmVudEVsZW1lbnQiLCJfaGFuZGxlTGlrZUNsaWNrIiwiZ2V0SWQiLCJzZXRMaWtlcyIsIl9yZW5kZXJMaWtlcyIsImlzTGlrZWQiLCJzb21lIiwidXNlciIsImNyZWF0ZUNhcmQiLCJzcmMiLCJvbmVycm9yIiwiYWx0IiwidGV4dENvbnRlbnQiLCJpZCIsIl9zZXRJbml0aWFsU3RhdGUiLCJfYWRkTGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsImxlbmd0aCIsImFkZCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsImJ1dHRvbiIsImlucHV0RWxlbWVudHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImlucHV0IiwiX3RvZ2dsZUlucHV0RXJyb3JEaXNwbGF5IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJldmVyeSIsIl9oaWRlRXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJfc2hvd0Vycm9yIiwiZm9ybSIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2VuYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiX2Rpc2FibGVCdXR0b24iLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dEVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwiU2VjdGlvbiIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lciIsImRvY3VtZW50IiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYXBwZW5kSXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJwcmVwZW5kSXRlbSIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJwb3B1cCIsImNsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImtleSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzIiwiZWxlbWVudHMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiZGF0YSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJmb3JtVmFsaWRhdG9ycyIsImNhcmRzU2VjdGlvbiIsInJlbmRlckxvYWRpbmciLCJtZXNzYWdlIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwicmVuZGVyQ2FyZCIsImNhcmREYXRhIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJ1c2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VyQWJvdXRTZWxlY3RvciIsInVzZXJQaWN0dXJlU2VsZWN0b3IiLCJ1c2VyTmFtZUVsZW1lbnQiLCJ1c2VyQWJvdXRFbGVtZW50IiwidXNlclBpY3R1cmVFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJhYm91dCIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJzZXRVc2VyUGljdHVyZSIsIl9yZWYzIiwiYXZhdGFyIiwiYXBpIiwib3B0aW9ucyIsIl91cmwiLCJ1cmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfZmV0Y2giLCJ1cGRhdGVVc2VySW5mbyIsImdldEluaXRpYWxDYXJkcyIsImFkZENhcmQiLCJjYXJkSW5mbyIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJ1cGRhdGVVc2VyUGljdHVyZSIsInRoZW4iLCJyZXMiLCJlbmRwb2ludCIsImJvZHkiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJmZXRjaE9wdGlvbnMiLCJtZXRob2QiLCJKU09OIiwic3RyaW5naWZ5IiwiZmV0Y2giLCJfY2hlY2tSZXNwb25zZSIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImF1dGhvcml6YXRpb24iLCJhbGwiLCJ1c2VyRGF0YSIsImluaXRpYWxDYXJkc0FycmF5IiwiY29uZmlybURlbGV0ZUJ0biIsImNhcmRJbnN0YW5jZSIsImNvbmZpcm1EZWxldGVQb3B1cCIsInNldEFjdGlvbiIsImdldEVsZW1lbnRCeUlkIiwiZmluYWxseSIsIl9jb25maXJtQnV0dG9uIiwiYWN0aW9uIiwicGljdHVyZVN1Ym1pdEJ0biIsImVkaXRQcm9maWxlUGljdHVyZUJ0biIsImVkaXRQcm9maWxlUGljdHVyZUZvcm0iLCJwcm9maWxlRm9ybVN1Ym1pdEJ0biIsImVkaXRQcm9maWxlQnRuIiwiZWRpdFByb2ZpbGVGb3JtIiwibmV3VXNlckRhdGEiLCJhZGRJbWFnZUJ0biIsImltYWdlRm9ybVN1Ym1pdEJ0biIsImFkZEltYWdlUG9wdXAiLCJuZXdDYXJkIiwiaW1hZ2VQb3B1cCIsInBvcHVwSW1hZ2UiLCJpbWFnZVBvcHVwVGl0bGUiLCJpbWFnZUxpbmsiLCJ0ZXh0IiwiY2FyZCIsInJlc0NhcmQiXSwic291cmNlUm9vdCI6IiJ9