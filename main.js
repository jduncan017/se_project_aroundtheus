!function(){"use strict";var e="";const t={formSelector:".popup__form",inputSelector:".popup__form-input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"popup__input-invalid",errorClass:"popup__error_visible"};class s{static cardImageLinks=[];constructor(e,t,s,r,i,n,o,a){let{name:c,link:l,owner:u,_id:d,likes:h}=e;this._text=c,this._imageLink=l,this._ownerId=u._id,this._cardId=d,this._cardLikesArray=h,this._userId=t,this._newCard=s.cloneNode(!0),this._cardImage=this._newCard.querySelector(".card__image"),this._cardTitle=this._newCard.querySelector(".card__title"),this._cardLikesCounter=this._newCard.querySelector(".card__likes-counter"),this._placeholderImage=r,this._handleCardClick=i,this._handleTrashClick=n,this._cardLikeBtn=this._newCard.querySelector(".card__like-button"),this._cardTrashBtn=this._newCard.querySelector(".card__trash-button"),this._cardSelector=this._cardTrashBtn.parentElement,this._duplicateCardsArray=o,this._handleLikeClick=a}getId(){return this._cardId}setLikes(e){this._cardLikesArray=e,this._renderLikes()}isLiked(){return this._cardLikesArray.some((e=>e._id===this._userId))}createCard(){return this._cardImage.src=this._imageLink,this._cardImage.onerror=()=>{this._cardImage.src=this._placeholderImage},this._cardImage.alt=this._text,this._cardTitle.textContent=this._text,this._newCard.id=this._cardId,this._checkForDuplicates(),this._setInitialState(),this._newCard}removeFromImageLinks(){const e=s.cardImageLinks.indexOf(this._imageLink);e>-1&&s.cardImageLinks.splice(e,1)}_addListeners(){this._cardLikeBtn.addEventListener("click",(()=>{this._cardLikeBtn.classList.toggle("card__like-button_active"),this._handleLikeClick(this)})),this._cardTrashBtn.addEventListener("click",(()=>this._handleTrashClick(this))),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._cardImage.src,this._text)}))}_checkForDuplicates(){const e=document.querySelector("#show-duplicates-checkbox");s.cardImageLinks.includes(this._imageLink)?(e.checked||this._newCard.classList.add("card_invisible"),this._duplicateCardsArray.push(this._newCard.id)):s.cardImageLinks.push(this._imageLink)}_setInitialState(){this._addListeners(),this._ownerId!==this._userId&&this._cardTrashBtn.remove(),this._renderLikes()}_renderLikes(){this._cardLikesCounter.textContent=this._cardLikesArray.length,this.isLiked()?this._cardLikeBtn.classList.add("card__like-button_active"):this._cardLikeBtn.classList.remove("card__like-button_active")}}class r{constructor(e,t){this.settings=e,this.formElement=t,this.button=t.querySelector(this.settings.submitButtonSelector),this.inputElements=Array.from(t.querySelectorAll(this.settings.inputSelector))}_setEventListeners(){this._toggleButtonState(),this.inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputErrorDisplay(this.formElement,e),this._toggleButtonState(this.inputElements)}))}))}_checkInputValidity(e){return e.validity.valid}_checkFormValidity(e){return e.every((e=>this._checkInputValidity(e)))}_hideError(e,t){t.classList.remove(this.settings.errorClass),e.classList.remove(this.settings.inputErrorClass)}_showError(e,t){t.classList.add(this.settings.errorClass),e.classList.add(this.settings.inputErrorClass)}_toggleInputErrorDisplay(e,t){const s=e.querySelector(`#${t.id}-error`);s.textContent=t.validationMessage,this._checkInputValidity(t)?this._hideError(t,s):this._showError(t,s)}_enableButton(e){e.classList.remove(this.settings.inactiveButtonClass),e.disabled=!1}_disableButton(e){e.classList.add(this.settings.inactiveButtonClass),e.disabled=!0}_toggleButtonState(){this._checkFormValidity(this.inputElements)?this._enableButton(this.button):this._disableButton(this.button)}resetValidation(){this._toggleButtonState(),this.inputElements.forEach((e=>{const t=this.formElement.querySelector(`#${e.id}-error`);this._hideError(e,t)}))}enableValidation(){this._setEventListeners()}}class i{constructor(e,t){let{items:s,renderer:r}=e;this.items=s,this.renderer=r,this.container=document.querySelector(t)}renderItems(){this.items.forEach((e=>{this.appendItem(this.renderer(e))}))}appendItem(e){this.container.append(e)}prependItem(e){this.container.prepend(e)}}class n{constructor(e){this.popup=document.querySelector(e),this.closeButton=this.popup.querySelector(".popup__close-button"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this.popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this.popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this.closeButton.addEventListener("click",(e=>{e.stopPropagation(),this.close()})),this.popup.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}_handleEscClose(e){"Escape"===e.key&&this.close()}}class o extends n{constructor(e,t){super(e),this._popupForm=this.popup.querySelector(".popup__form"),this._handleFormSubmit=t,this._inputList=Array.from(this._popupForm.querySelectorAll("input"))}_getInputValues(){const e=Array.from(this._popupForm.elements),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.stopPropagation(),e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._popupForm.reset()}}var a=e+"4d1dba3d8f0a3d9f693e.png";const c={};let l=null,u=null;function d(e,t){e.textContent=t}const h=document.querySelector("#cards").content.firstElementChild;function p(e){return new s(e,u,h,a,A,f,E,x).createCard()}Array.from(document.querySelectorAll(t.formSelector)).forEach((e=>{const s=new r(t,e),i=e.getAttribute("name");c[i]=s,s.enableValidation()}));const _=new class{constructor(e){let{userNameSelector:t,userAboutSelector:s,userPictureSelector:r}=e;this.userNameElement=document.querySelector(t),this.userAboutElement=document.querySelector(s),this.userPictureElement=document.querySelector(r)}getUserInfo(){return{name:this.userNameElement.textContent,about:this.userAboutElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this.userNameElement.textContent=t,this.userAboutElement.textContent=s}setUserPicture(e){let{avatar:t}=e;this.userPictureElement.src=t}}({userNameSelector:".profile__name-title",userAboutSelector:".profile__about",userPictureSelector:".profile__picture"}),m=new class{constructor(e){this._url=e.url,this._headers=e.headers}getUserInfo(){return this._fetch("/users/me")}updateUserInfo(e){return this._fetch("/users/me","PATCH",e)}getInitialCards(){return this._fetch("/cards")}addCard(e){return this._fetch("/cards","POST",e)}deleteCard(e){return this._fetch(`/cards/${e}`,"DELETE")}likeCard(e){return this._fetch(`/cards/likes/${e}`,"PUT")}unlikeCard(e){return this._fetch(`/cards/likes/${e}`,"DELETE")}updateUserPicture(e){return this._fetch("/users/me/avatar","PATCH",e).then((e=>{document.querySelector(".profile__picture").src=e.avatar}))}_fetch(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s={method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",headers:this._headers};return t&&(s.body=JSON.stringify(t)),fetch(`${this._url}${e}`,s).then(this._checkResponse).catch((e=>console.error(e)))}_checkResponse(e){return e.ok?e.json():Promise.reject(`Oops there's an error!: ${e.status}`)}}({url:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"c1d3050f-9f71-48b4-9235-936056aa4e95","Content-Type":"application/json"}});Promise.all([m.getUserInfo(),m.getInitialCards()]).then((e=>{let[t,s]=e;_.setUserPicture({avatar:t.avatar}),_.setUserInfo({name:t.name,about:t.about}),u=t._id,l=new i({items:s,renderer:p},".cards__list"),l.renderItems()})).catch((e=>{console.error(`Error: ${e}`)}));const g=document.querySelector("#confirm-delete-button");function f(e){k.open(),k.setAction((()=>(d(g,"Deleting..."),function(e){const t=document.getElementById(e).querySelector(".card__image");E=E.filter((t=>t!==e)),s.cardImageLinks=s.cardImageLinks.filter((e=>e!==t.src))}(e),m.deleteCard(e.getId()).then((()=>{document.getElementById(e.getId()).remove(),k.close()})).catch((e=>{console.error(`Error: ${e}`)})).finally((()=>{d(g,"Yes")})),g)))}const k=new class extends n{constructor(e){super(e),this._confirmButton=this.popup.querySelector(".confirm-popup__submit-button")}setAction(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}("#confirm-delete-popup");k.setEventListeners();let E=[];document.querySelector("#show-duplicates-checkbox").addEventListener("change",(e=>{E.forEach((t=>{const s=document.getElementById(t);e.target.checked?s.classList.remove("card_invisible"):s.classList.add("card_invisible")}))}));const L=document.querySelector("#picture-submit-button"),v=document.querySelector(".profile__picture-overlay"),y=new o("#edit-profile-picture-popup",(function(e){d(L,"Saving..."),m.updateUserPicture({avatar:e.link}).then((()=>{y.close()})).catch((e=>{console.error(`Error: ${e}`)})).finally((()=>{d(L,"Save")}))}));y.setEventListeners(),v.addEventListener("click",(function(){c["edit-profile-picture-form"].resetValidation(),y.open()}));const b=document.querySelector("#profile-submit-button"),S=document.querySelector(".profile__name-button"),I=new o("#edit-popup",(function(e){d(b,"Saving..."),m.updateUserInfo({name:e.name,about:e.about}).then((e=>{_.setUserInfo({name:e.name,about:e.about}),I.close()})).catch((e=>{console.error(`Error: ${e}`)})).finally((()=>{d(b,"Save")}))}));I.setEventListeners(),S.addEventListener("click",(function(){c["edit-profile-form"].resetValidation();const e=_.getUserInfo();I.setInputValues(e),I.open()}));const C=document.querySelector(".profile__add-button"),q=document.querySelector("#image-submit-button"),w=new o("#add-image-popup",(function(e){d(q,"Saving..."),m.addCard({name:e.name,link:e.link}).then((e=>{const t=p(e);l.prependItem(t),w.close()})).catch((e=>{console.error(e)})).finally((()=>{d(q,"Save")}))}));w.setEventListeners(),C.addEventListener("click",(()=>{c["add-image-form"].resetValidation(),w.open()}));const B=new class extends n{constructor(e){super(e),this.popupImage=this.popup.querySelector(".image-popup__image"),this.imagePopupTitle=this.popup.querySelector(".image-popup__title")}open(e,t){this.popupImage.src=e,this.popupImage.alt=t,this.imagePopupTitle.textContent=t,super.open()}}("#image-popup");function A(e,t){B.open(e,t)}function x(e){const t=e.isLiked()?"unlikeCard":"likeCard";m[t](e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.error(`Error: ${e}`)}))}B.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBT3ZILE9BQzFDeUssTUFBTUMsSUFDTCxNQUFNOEMsRUFBVWxGLEVBQVdvQyxHQUMzQjFDLEVBQWFqQyxZQUFZeUgsR0FDekJELEVBQWMvRyxPQUFPLElBRXRCNkUsT0FBT0MsSUFDTkMsUUFBUUQsTUFBTUEsRUFBTSxJQUVyQm9CLFNBQVEsS0FDUHpFLEVBQWNxRixFQUFvQixPQUFPLEdBRS9DLElBeEJBQyxFQUFjN0csb0JBR2QyRyxFQUFZdkssaUJBQWlCLFNBQVMsS0FDcENpRixFQUFlLGtCQUFrQjdDLGtCQUNqQ3FJLEVBQWNoSCxNQUFNLElBc0J0QixNQUFNa0gsRUFBYSxJSTNSSixjQUE2QnhILEVBQzFDM0csWUFBWTRHLEdBQ1ZnQixNQUFNaEIsR0FDTjlGLEtBQUtzTixXQUFhdE4sS0FBSytGLE1BQU1yRixjQUFjLHVCQUMzQ1YsS0FBS3VOLGdCQUFrQnZOLEtBQUsrRixNQUFNckYsY0FBYyxzQkFDbEQsQ0FDQXlGLEtBQUtpRyxFQUFXb0IsR0FDZHhOLEtBQUtzTixXQUFXekwsSUFBTXVLLEVBQ3RCcE0sS0FBS3NOLFdBQVd2TCxJQUFNeUwsRUFDdEJ4TixLQUFLdU4sZ0JBQWdCdkwsWUFBY3dMLEVBQ25DMUcsTUFBTVgsTUFDUixHSmdSb0MsZ0JBR3RDLFNBQVM1RyxFQUFnQjZNLEVBQVdvQixHQUNsQ0gsRUFBV2xILEtBQUtpRyxFQUFXb0IsRUFDN0IsQ0FLQSxTQUFTOU4sRUFBZ0IrTSxHQUN2QixNQUFNN0IsRUFBUzZCLEVBQUtoTCxVQUFZLGFBQWUsV0FFL0M0SCxFQUFJdUIsR0FBUTZCLEVBQUtuTCxTQUNkK0ksTUFBTW9ELElBQ0xoQixFQUFLbEwsU0FBU2tNLEVBQVExTixNQUFNLElBRTdCa0wsT0FBT0MsSUFDTkMsUUFBUUQsTUFBTyxVQUFTQSxJQUFRLEdBRXRDLENBbkJBbUMsRUFBVy9HLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmRfdGhlX3VzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmRfdGhlX3VzLy4vc3JjL2Zhdmljb24uaWNvIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybS1pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWludmFsaWRcIixcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgc3RhdGljIGNhcmRJbWFnZUxpbmtzID0gW107XG5cbiAgY29uc3RydWN0b3IoXG4gICAgeyBuYW1lLCBsaW5rLCBvd25lciwgX2lkLCBsaWtlcyB9LFxuICAgIHVzZXJJZCxcbiAgICB0ZW1wbGF0ZUVsZW1lbnQsXG4gICAgcGxhY2Vob2xkZXJJbWFnZSxcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXG4gICAgaGFuZGxlVHJhc2hDbGljayxcbiAgICBkdXBsaWNhdGVDYXJkc0FycmF5LFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLl90ZXh0ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZUxpbmsgPSBsaW5rO1xuICAgIHRoaXMuX293bmVySWQgPSBvd25lci5faWQ7XG4gICAgdGhpcy5fY2FyZElkID0gX2lkO1xuICAgIHRoaXMuX2NhcmRMaWtlc0FycmF5ID0gbGlrZXM7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIHRoaXMuX25ld0NhcmQgPSB0ZW1wbGF0ZUVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9uZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgdGhpcy5fY2FyZExpa2VzQ291bnRlciA9IHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2xpa2VzLWNvdW50ZXJcIlxuICAgICk7XG4gICAgdGhpcy5fcGxhY2Vob2xkZXJJbWFnZSA9IHBsYWNlaG9sZGVySW1hZ2U7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZVRyYXNoQ2xpY2sgPSBoYW5kbGVUcmFzaENsaWNrO1xuICAgIHRoaXMuX2NhcmRMaWtlQnRuID0gdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2NhcmRUcmFzaEJ0biA9IHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gdGhpcy5fY2FyZFRyYXNoQnRuLnBhcmVudEVsZW1lbnQ7XG4gICAgdGhpcy5fZHVwbGljYXRlQ2FyZHNBcnJheSA9IGR1cGxpY2F0ZUNhcmRzQXJyYXk7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICB9XG5cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4gIC8qICAgICAgICAgICAgIFBVQkxJQyBNRVRIT0RTICAgICAgICAgICAgICAqL1xuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuICBnZXRJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fY2FyZElkO1xuICB9XG5cbiAgc2V0TGlrZXMobGlrZXMpIHtcbiAgICB0aGlzLl9jYXJkTGlrZXNBcnJheSA9IGxpa2VzO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9jYXJkTGlrZXNBcnJheS5zb21lKCh1c2VyKSA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2ltYWdlTGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2Uub25lcnJvciA9ICgpID0+IHtcbiAgICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9wbGFjZWhvbGRlckltYWdlO1xuICAgIH07XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX3RleHQ7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcbiAgICB0aGlzLl9uZXdDYXJkLmlkID0gdGhpcy5fY2FyZElkO1xuXG4gICAgdGhpcy5fY2hlY2tGb3JEdXBsaWNhdGVzKCk7XG4gICAgdGhpcy5fc2V0SW5pdGlhbFN0YXRlKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fbmV3Q2FyZDtcbiAgfVxuXG4gIHJlbW92ZUZyb21JbWFnZUxpbmtzKCkge1xuICAgIGNvbnN0IGluZGV4ID0gQ2FyZC5jYXJkSW1hZ2VMaW5rcy5pbmRleE9mKHRoaXMuX2ltYWdlTGluayk7XG4gICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgIENhcmQuY2FyZEltYWdlTGlua3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gIH1cblxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgLyogICAgICAgICAgICAgUFJJVkFURSBNRVRIT0RTICAgICAgICAgICAgICovXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4gIF9hZGRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2NhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkVHJhc2hCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVUcmFzaENsaWNrKHRoaXMpXG4gICAgKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX2NhcmRJbWFnZS5zcmMsIHRoaXMuX3RleHQpO1xuICAgIH0pO1xuICB9XG5cbiAgX2NoZWNrRm9yRHVwbGljYXRlcygpIHtcbiAgICBjb25zdCBzaG93RHVwbGljYXRlc0NoZWNrYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiI3Nob3ctZHVwbGljYXRlcy1jaGVja2JveFwiXG4gICAgKTtcblxuICAgIGlmIChDYXJkLmNhcmRJbWFnZUxpbmtzLmluY2x1ZGVzKHRoaXMuX2ltYWdlTGluaykpIHtcbiAgICAgIGlmICghc2hvd0R1cGxpY2F0ZXNDaGVja2JveC5jaGVja2VkKSB7XG4gICAgICAgIHRoaXMuX25ld0NhcmQuY2xhc3NMaXN0LmFkZChcImNhcmRfaW52aXNpYmxlXCIpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9kdXBsaWNhdGVDYXJkc0FycmF5LnB1c2godGhpcy5fbmV3Q2FyZC5pZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIENhcmQuY2FyZEltYWdlTGlua3MucHVzaCh0aGlzLl9pbWFnZUxpbmspO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgdGhpcy5fYWRkTGlzdGVuZXJzKCk7XG5cbiAgICBpZiAoISh0aGlzLl9vd25lcklkID09PSB0aGlzLl91c2VySWQpKSB7XG4gICAgICB0aGlzLl9jYXJkVHJhc2hCdG4ucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpIHtcbiAgICB0aGlzLl9jYXJkTGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fY2FyZExpa2VzQXJyYXkubGVuZ3RoO1xuXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuYnV0dG9uID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLmlucHV0RWxlbWVudHMgPSBBcnJheS5mcm9tKFxuICAgICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNldHRpbmdzLmlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuaW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvckRpc3BsYXkodGhpcy5mb3JtRWxlbWVudCwgaW5wdXQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLmlucHV0RWxlbWVudHMpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XG4gICAgcmV0dXJuIGlucHV0LnZhbGlkaXR5LnZhbGlkO1xuICB9XG5cbiAgX2NoZWNrRm9ybVZhbGlkaXR5KGlucHV0RWxlbWVudHMpIHtcbiAgICByZXR1cm4gaW5wdXRFbGVtZW50cy5ldmVyeSgoaW5wdXQpID0+IHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkpO1xuICB9XG5cbiAgX2hpZGVFcnJvcihpbnB1dCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgZXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9zaG93RXJyb3IoaW5wdXQsIGVycm9yTWVzc2FnZSkge1xuICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QuYWRkKHRoaXMuc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLnNldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlSW5wdXRFcnJvckRpc3BsYXkoZm9ybSwgaW5wdXQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIGVycm9yTWVzc2FnZS50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGlmICh0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpKSB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXQsIGVycm9yTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3Nob3dFcnJvcihpbnB1dCwgZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKGJ1dHRvbikge1xuICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfZGlzYWJsZUJ1dHRvbihidXR0b24pIHtcbiAgICBidXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLnNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2NoZWNrRm9ybVZhbGlkaXR5KHRoaXMuaW5wdXRFbGVtZW50cykpIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbih0aGlzLmJ1dHRvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24odGhpcy5idXR0b24pO1xuICAgIH1cbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuaW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgICApO1xuICAgICAgdGhpcy5faGlkZUVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLmFwcGVuZEl0ZW0odGhpcy5yZW5kZXJlcihpdGVtKSk7XG4gICAgfSk7XG4gIH1cblxuICBhcHBlbmRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XG4gIH1cblxuICBwcmVwZW5kSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5jbG9zZUJ1dHRvbiA9IHRoaXMucG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICAvKiAgICAgICAgICAgICBQVUJMSUMgTUVUSE9EUyAgICAgICAgICAgICAgKi9cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLnBvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgdGhpcy5wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gZXZlbnQuY3VycmVudFRhcmdldCkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgLyogICAgICAgICAgICAgUFJJVkFURSBNRVRIT0RTICAgICAgICAgICAgICovXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMucG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIikpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20odGhpcy5fcG9wdXBGb3JtLmVsZW1lbnRzKTtcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB2YWx1ZXM7XG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgfSk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCJmYXZpY29uLmljb1wiOyIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgIElNUE9SVFMgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmltcG9ydCB1c2VyQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFBvcHVwQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBcIi4uL2Zhdmljb24uaWNvXCI7XG5pbXBvcnQgcGxhY2Vob2xkZXJJbWFnZSBmcm9tIFwiLi4vaW1hZ2VzL05vLUltYWdlLVBsYWNlaG9sZGVyLnBuZ1wiO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICBGSUxFIFZBUklBQkxFIERFRklOSVRJT05TICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG5sZXQgY2FyZHNTZWN0aW9uID0gbnVsbDtcbmxldCB1c2VySWQgPSBudWxsO1xuXG5mdW5jdGlvbiByZW5kZXJMb2FkaW5nKGJ1dHRvbiwgbWVzc2FnZSkge1xuICBidXR0b24udGV4dENvbnRlbnQgPSBtZXNzYWdlO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICBJTklUSUFMIFJFTkRFUklORyAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vLyB2YXJpYWJsZSBkZWZpbml0aW9uc1xuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZHNcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcbmNvbnN0IGZvcm1FbGVtZW50cyA9IEFycmF5LmZyb20oXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKVxuKTtcblxuLy8gYWRkIHZhbGlkYXRpb24gdG8gYWxsIGZvcm1zXG5mb3JtRWxlbWVudHMuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcbiAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xuICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG59KTtcblxuLy8gRlVOQ1RJT05TXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICB1c2VySWQsXG4gICAgY2FyZFRlbXBsYXRlLFxuICAgIHBsYWNlaG9sZGVySW1hZ2UsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZVRyYXNoQ2xpY2ssXG4gICAgZHVwbGljYXRlQ2FyZHNBcnJheSxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgcmV0dXJuIGNhcmQuY3JlYXRlQ2FyZCgpO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICBGRVRDSCBTSVRFIERBVEEgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vLyBWYXJpYWJsZXM6XG5jb25zdCB1c2VySW5mb1NlbGVjdG9yID0ge1xuICB1c2VyTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lLXRpdGxlXCIsXG4gIHVzZXJBYm91dFNlbGVjdG9yOiBcIi5wcm9maWxlX19hYm91dFwiLFxuICB1c2VyUGljdHVyZVNlbGVjdG9yOiBcIi5wcm9maWxlX19waWN0dXJlXCIsXG59O1xuXG4vLyBDcmVhdGUgQ2xhc3NlczpcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHVzZXJJbmZvU2VsZWN0b3IpO1xuY29uc3QgYXBpID0gbmV3IHVzZXJBcGkoe1xuICB1cmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJjMWQzMDUwZi05ZjcxLTQ4YjQtOTIzNS05MzYwNTZhYTRlOTVcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbdXNlckRhdGEsIGluaXRpYWxDYXJkc0FycmF5XSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJQaWN0dXJlKHsgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIgfSk7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcbiAgICAgIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcbiAgICB9KTtcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XG5cbiAgICBjYXJkc1NlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHsgaXRlbXM6IGluaXRpYWxDYXJkc0FycmF5LCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxuICAgICAgXCIuY2FyZHNfX2xpc3RcIlxuICAgICk7XG4gICAgY2FyZHNTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogJHtlcnJvcn1gKTtcbiAgfSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICBDT05GSVJNIERFTEVURSBQT1BVUCAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8vIFZhcmlhYmxlczpcbmNvbnN0IGNvbmZpcm1EZWxldGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbmZpcm0tZGVsZXRlLWJ1dHRvblwiKTtcblxuZnVuY3Rpb24gaGFuZGxlVHJhc2hDbGljayhjYXJkSW5zdGFuY2UpIHtcbiAgY29uZmlybURlbGV0ZVBvcHVwLm9wZW4oKTtcbiAgY29uZmlybURlbGV0ZVBvcHVwLnNldEFjdGlvbigoKSA9PiB7XG4gICAgcmVuZGVyTG9hZGluZyhjb25maXJtRGVsZXRlQnRuLCBcIkRlbGV0aW5nLi4uXCIpO1xuICAgIHJlbW92ZUZyb21JbWFnZUxpbmtzQXJyYXkoY2FyZEluc3RhbmNlKTtcbiAgICByZXR1cm4gKFxuICAgICAgYXBpXG4gICAgICAgIC5kZWxldGVDYXJkKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYXJkSW5zdGFuY2UuZ2V0SWQoKSk7XG4gICAgICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgY29uZmlybURlbGV0ZVBvcHVwLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogJHtlcnJvcn1gKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgIHJlbmRlckxvYWRpbmcoY29uZmlybURlbGV0ZUJ0biwgXCJZZXNcIik7XG4gICAgICAgIH0pLFxuICAgICAgY29uZmlybURlbGV0ZUJ0blxuICAgICk7XG4gIH0pO1xufVxuXG4vLyBDcmVhdGUgUG9wdXA6XG5jb25zdCBjb25maXJtRGVsZXRlUG9wdXAgPSBuZXcgUG9wdXBDb25maXJtKFwiI2NvbmZpcm0tZGVsZXRlLXBvcHVwXCIpO1xuY29uZmlybURlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICBTSE9XIERVUExJQ0FURVMgRlVOQ1RJT05BTElUWSAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8vIGFycmF5IGZvciByZW1lbWJlcmluZyBkdXBsaWNhdGVzXG5sZXQgZHVwbGljYXRlQ2FyZHNBcnJheSA9IFtdO1xuXG4vLyBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBjaGVja2JveFxuY29uc3Qgc2hvd0R1cGxpY2F0ZXNDaGVja2JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Nob3ctZHVwbGljYXRlcy1jaGVja2JveFwiXG4pO1xuc2hvd0R1cGxpY2F0ZXNDaGVja2JveC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChldmVudCkgPT4ge1xuICBkdXBsaWNhdGVDYXJkc0FycmF5LmZvckVhY2goKGNhcmRJZCkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYXJkSWQpO1xuICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCkge1xuICAgICAgY2FyZC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9pbnZpc2libGVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhcmQuY2xhc3NMaXN0LmFkZChcImNhcmRfaW52aXNpYmxlXCIpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuLy8gZnVuY3Rpb24gZGVsZXRlcyBjYXJkcyBmcm9tIGR1cGxpY2F0ZXMgYXJyYXkgd2hlbiB0aGV5IGFyZSBkZWxldGVkIGZyb20gdGhlIHNlcnZlclxuZnVuY3Rpb24gcmVtb3ZlRnJvbUltYWdlTGlua3NBcnJheShjYXJkSWQpIHtcbiAgLy8gdmFyaWFibGUgZGVmaW5pdGlvbnNcbiAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhcmRJZCk7XG4gIGNvbnN0IGNhcmRJbWFnZSA9IGNhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgLy8gcmVtb3ZlIGZyb20gZHVwbGljYXRlQ2FyZHNBcnJheVxuICBkdXBsaWNhdGVDYXJkc0FycmF5ID0gZHVwbGljYXRlQ2FyZHNBcnJheS5maWx0ZXIoKGlkKSA9PiBpZCAhPT0gY2FyZElkKTtcbiAgQ2FyZC5jYXJkSW1hZ2VMaW5rcyA9IENhcmQuY2FyZEltYWdlTGlua3MuZmlsdGVyKChpbWFnZUxpbmspID0+IHtcbiAgICByZXR1cm4gaW1hZ2VMaW5rICE9PSBjYXJkSW1hZ2Uuc3JjO1xuICB9KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgUFJPRklMRSBQSUNUVVJFIEVESVQgRk9STSAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8vIFZhcmlhYmxlczpcbmNvbnN0IHBpY3R1cmVTdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BpY3R1cmUtc3VibWl0LWJ1dHRvblwiKTtcbmNvbnN0IGVkaXRQcm9maWxlUGljdHVyZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX3BpY3R1cmUtb3ZlcmxheVwiXG4pO1xuXG4vLyBDcmVhdGUgUG9wdXA6XG5jb25zdCBlZGl0UHJvZmlsZVBpY3R1cmVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2VkaXQtcHJvZmlsZS1waWN0dXJlLXBvcHVwXCIsXG4gIGhhbmRsZVBpY3R1cmVGb3JtU3VibWl0XG4pO1xuZWRpdFByb2ZpbGVQaWN0dXJlRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBGdW5jdGlvbmFsaXR5IGZvciB0aGUgcHJvZmlsZSBwaWN0dXJlIGJ1dHRvblxuZWRpdFByb2ZpbGVQaWN0dXJlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGZvcm1WYWxpZGF0b3JzW1wiZWRpdC1wcm9maWxlLXBpY3R1cmUtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgZWRpdFByb2ZpbGVQaWN0dXJlRm9ybS5vcGVuKCk7XG59KTtcblxuLy8gSGFuZGxlIEZvcm0gU3VibWlzc2lvbjpcbmZ1bmN0aW9uIGhhbmRsZVBpY3R1cmVGb3JtU3VibWl0KGlucHV0cykge1xuICByZW5kZXJMb2FkaW5nKHBpY3R1cmVTdWJtaXRCdG4sIFwiU2F2aW5nLi4uXCIpO1xuICBhcGlcbiAgICAudXBkYXRlVXNlclBpY3R1cmUoeyBhdmF0YXI6IGlucHV0cy5saW5rIH0pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgZWRpdFByb2ZpbGVQaWN0dXJlRm9ybS5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICByZW5kZXJMb2FkaW5nKHBpY3R1cmVTdWJtaXRCdG4sIFwiU2F2ZVwiKTtcbiAgICB9KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgUFJPRklMRSBFRElUIEZPUk0gICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLy8gVmFyaWFibGVzOlxuY29uc3QgcHJvZmlsZUZvcm1TdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtc3VibWl0LWJ1dHRvblwiKTtcbmNvbnN0IGVkaXRQcm9maWxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lLWJ1dHRvblwiKTtcblxuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2VkaXQtcG9wdXBcIixcbiAgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXRcbik7XG5lZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gRWRpdCBCdXR0b24gRnVuY3Rpb25hbGl0eTpcbmVkaXRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGZvcm1WYWxpZGF0b3JzW1wiZWRpdC1wcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGNvbnN0IGRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBlZGl0UHJvZmlsZUZvcm0uc2V0SW5wdXRWYWx1ZXMoZGF0YSk7XG4gIGVkaXRQcm9maWxlRm9ybS5vcGVuKCk7XG59KTtcblxuLy8gSGFuZGxlIEZvcm0gU3VibWlzc2lvbjpcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGlucHV0cykge1xuICByZW5kZXJMb2FkaW5nKHByb2ZpbGVGb3JtU3VibWl0QnRuLCBcIlNhdmluZy4uLlwiKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJJbmZvKHsgbmFtZTogaW5wdXRzLm5hbWUsIGFib3V0OiBpbnB1dHMuYWJvdXQgfSlcbiAgICAudGhlbigobmV3VXNlckRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgbmFtZTogbmV3VXNlckRhdGEubmFtZSxcbiAgICAgICAgYWJvdXQ6IG5ld1VzZXJEYXRhLmFib3V0LFxuICAgICAgfSk7XG4gICAgICBlZGl0UHJvZmlsZUZvcm0uY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yOiAke2Vycm9yfWApO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcmVuZGVyTG9hZGluZyhwcm9maWxlRm9ybVN1Ym1pdEJ0biwgXCJTYXZlXCIpO1xuICAgIH0pO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgIEFERCBJTUFHRSBGT1JNICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vLyBWYXJpYWJsZXM6XG5jb25zdCBhZGRJbWFnZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmNvbnN0IGltYWdlRm9ybVN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2Utc3VibWl0LWJ1dHRvblwiKTtcblxuLy8gQ3JlYXRlIFBvcHVwOlxuY29uc3QgYWRkSW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhZGQtaW1hZ2UtcG9wdXBcIixcbiAgaGFuZGxlSW1hZ2VGb3JtU3VibWl0XG4pO1xuYWRkSW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBBZGQgQnV0dG9uIEZ1bmN0aW9uYWxpdHk6XG5hZGRJbWFnZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1tcImFkZC1pbWFnZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBhZGRJbWFnZVBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyBIYW5kbGUgRm9ybSBTdWJtaXNzaW9uOlxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VGb3JtU3VibWl0KGlucHV0cykge1xuICByZW5kZXJMb2FkaW5nKGltYWdlRm9ybVN1Ym1pdEJ0biwgXCJTYXZpbmcuLi5cIik7XG4gIGFwaVxuICAgIC5hZGRDYXJkKHsgbmFtZTogaW5wdXRzLm5hbWUsIGxpbms6IGlucHV0cy5saW5rIH0pXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgY29uc3QgbmV3Q2FyZCA9IHJlbmRlckNhcmQocmVzKTtcbiAgICAgIGNhcmRzU2VjdGlvbi5wcmVwZW5kSXRlbShuZXdDYXJkKTtcbiAgICAgIGFkZEltYWdlUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcmVuZGVyTG9hZGluZyhpbWFnZUZvcm1TdWJtaXRCdG4sIFwiU2F2ZVwiKTtcbiAgICB9KTtcbn1cblxuLy8gQ3JlYXRlIFBvcHVwOlxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZS1wb3B1cFwiKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGltYWdlTGluaywgdGV4dCkge1xuICBpbWFnZVBvcHVwLm9wZW4oaW1hZ2VMaW5rLCB0ZXh0KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgTGlrZSBCdXR0b24gRnVuY3Rpb25hbGl0eSAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcbiAgY29uc3QgbWV0aG9kID0gY2FyZC5pc0xpa2VkKCkgPyBcInVubGlrZUNhcmRcIiA6IFwibGlrZUNhcmRcIjtcblxuICBhcGlbbWV0aG9kXShjYXJkLmdldElkKCkpXG4gICAgLnRoZW4oKHJlc0NhcmQpID0+IHtcbiAgICAgIGNhcmQuc2V0TGlrZXMocmVzQ2FyZC5saWtlcyk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogJHtlcnJvcn1gKTtcbiAgICB9KTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZVNlbGVjdG9yLCB1c2VyQWJvdXRTZWxlY3RvciwgdXNlclBpY3R1cmVTZWxlY3RvciB9KSB7XG4gICAgdGhpcy51c2VyTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMudXNlckFib3V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckFib3V0U2VsZWN0b3IpO1xuICAgIHRoaXMudXNlclBpY3R1cmVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyUGljdHVyZVNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLnVzZXJOYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLnVzZXJBYm91dEVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHRoaXMudXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLnVzZXJBYm91dEVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIHNldFVzZXJQaWN0dXJlKHsgYXZhdGFyIH0pIHtcbiAgICB0aGlzLnVzZXJQaWN0dXJlRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIHVzZXJBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5fdXJsID0gb3B0aW9ucy51cmw7XG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICAvKiAgICAgICAgICAgICBQVUJMSUMgTUVUSE9EUyAgICAgICAgICAgICAgKi9cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZldGNoKFwiL3VzZXJzL21lXCIpO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8odXNlckluZm8pIHtcbiAgICByZXR1cm4gdGhpcy5fZmV0Y2goXCIvdXNlcnMvbWVcIiwgXCJQQVRDSFwiLCB1c2VySW5mbyk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZldGNoKFwiL2NhcmRzXCIpO1xuICB9XG5cbiAgYWRkQ2FyZChjYXJkSW5mbykge1xuICAgIHJldHVybiB0aGlzLl9mZXRjaChcIi9jYXJkc1wiLCBcIlBPU1RcIiwgY2FyZEluZm8pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fZmV0Y2goYC9jYXJkcy8ke2NhcmRJZH1gLCBcIkRFTEVURVwiKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9mZXRjaChgL2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIFwiUFVUXCIpO1xuICB9XG5cbiAgdW5saWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fZmV0Y2goYC9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCBcIkRFTEVURVwiKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJQaWN0dXJlKGF2YXRhcikge1xuICAgIHJldHVybiB0aGlzLl9mZXRjaChcIi91c2Vycy9tZS9hdmF0YXJcIiwgXCJQQVRDSFwiLCBhdmF0YXIpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgY29uc3QgcHJvZmlsZVBpY3R1cmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BpY3R1cmVcIik7XG4gICAgICBwcm9maWxlUGljdHVyZS5zcmMgPSByZXMuYXZhdGFyO1xuICAgIH0pO1xuICB9XG5cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4gIC8qICAgICAgICAgICAgIFBSSVZBVEUgTUVUSE9EUyAgICAgICAgICAgICAqL1xuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuICBfZmV0Y2goZW5kcG9pbnQsIG1ldGhvZCA9IFwiR0VUXCIsIGJvZHkgPSBudWxsKSB7XG4gICAgY29uc3QgZmV0Y2hPcHRpb25zID0ge1xuICAgICAgbWV0aG9kLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9O1xuXG4gICAgaWYgKGJvZHkpIHtcbiAgICAgIGZldGNoT3B0aW9ucy5ib2R5ID0gSlNPTi5zdHJpbmdpZnkoYm9keSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0ke2VuZHBvaW50fWAsIGZldGNoT3B0aW9ucylcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKGVycm9yKSk7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBPb3BzIHRoZXJlJ3MgYW4gZXJyb3IhOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gdGhpcy5wb3B1cC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY29uZmlybS1wb3B1cF9fc3VibWl0LWJ1dHRvblwiXG4gICAgKTtcbiAgfVxuXG4gIHNldEFjdGlvbihhY3Rpb24pIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gYWN0aW9uO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMucG9wdXBJbWFnZSA9IHRoaXMucG9wdXAucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1wb3B1cF9faW1hZ2VcIik7XG4gICAgdGhpcy5pbWFnZVBvcHVwVGl0bGUgPSB0aGlzLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtcG9wdXBfX3RpdGxlXCIpO1xuICB9XG4gIG9wZW4oaW1hZ2VMaW5rLCB0ZXh0KSB7XG4gICAgdGhpcy5wb3B1cEltYWdlLnNyYyA9IGltYWdlTGluaztcbiAgICB0aGlzLnBvcHVwSW1hZ2UuYWx0ID0gdGV4dDtcbiAgICB0aGlzLmltYWdlUG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJDYXJkIiwic3RhdGljIiwiY29uc3RydWN0b3IiLCJfcmVmIiwidXNlcklkIiwidGVtcGxhdGVFbGVtZW50IiwicGxhY2Vob2xkZXJJbWFnZSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZVRyYXNoQ2xpY2siLCJkdXBsaWNhdGVDYXJkc0FycmF5IiwiaGFuZGxlTGlrZUNsaWNrIiwibmFtZSIsImxpbmsiLCJvd25lciIsIl9pZCIsImxpa2VzIiwidGhpcyIsIl90ZXh0IiwiX2ltYWdlTGluayIsIl9vd25lcklkIiwiX2NhcmRJZCIsIl9jYXJkTGlrZXNBcnJheSIsIl91c2VySWQiLCJfbmV3Q2FyZCIsImNsb25lTm9kZSIsIl9jYXJkSW1hZ2UiLCJxdWVyeVNlbGVjdG9yIiwiX2NhcmRUaXRsZSIsIl9jYXJkTGlrZXNDb3VudGVyIiwiX3BsYWNlaG9sZGVySW1hZ2UiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZVRyYXNoQ2xpY2siLCJfY2FyZExpa2VCdG4iLCJfY2FyZFRyYXNoQnRuIiwiX2NhcmRTZWxlY3RvciIsInBhcmVudEVsZW1lbnQiLCJfZHVwbGljYXRlQ2FyZHNBcnJheSIsIl9oYW5kbGVMaWtlQ2xpY2siLCJnZXRJZCIsInNldExpa2VzIiwiX3JlbmRlckxpa2VzIiwiaXNMaWtlZCIsInNvbWUiLCJ1c2VyIiwiY3JlYXRlQ2FyZCIsInNyYyIsIm9uZXJyb3IiLCJhbHQiLCJ0ZXh0Q29udGVudCIsImlkIiwiX2NoZWNrRm9yRHVwbGljYXRlcyIsIl9zZXRJbml0aWFsU3RhdGUiLCJyZW1vdmVGcm9tSW1hZ2VMaW5rcyIsImluZGV4IiwiY2FyZEltYWdlTGlua3MiLCJpbmRleE9mIiwic3BsaWNlIiwiX2FkZExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJzaG93RHVwbGljYXRlc0NoZWNrYm94IiwiZG9jdW1lbnQiLCJpbmNsdWRlcyIsImNoZWNrZWQiLCJhZGQiLCJwdXNoIiwicmVtb3ZlIiwibGVuZ3RoIiwiRm9ybVZhbGlkYXRvciIsImZvcm1FbGVtZW50IiwiYnV0dG9uIiwiaW5wdXRFbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiaW5wdXQiLCJfdG9nZ2xlSW5wdXRFcnJvckRpc3BsYXkiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0Zvcm1WYWxpZGl0eSIsImV2ZXJ5IiwiX2hpZGVFcnJvciIsImVycm9yTWVzc2FnZSIsIl9zaG93RXJyb3IiLCJmb3JtIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfZW5hYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZGlzYWJsZUJ1dHRvbiIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0RWxlbWVudCIsImVuYWJsZVZhbGlkYXRpb24iLCJTZWN0aW9uIiwic2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYXBwZW5kSXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJwcmVwZW5kSXRlbSIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJwb3B1cCIsImNsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImtleSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzIiwiZWxlbWVudHMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiZGF0YSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJmb3JtVmFsaWRhdG9ycyIsImNhcmRzU2VjdGlvbiIsInJlbmRlckxvYWRpbmciLCJtZXNzYWdlIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwicmVuZGVyQ2FyZCIsImNhcmREYXRhIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJ1c2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VyQWJvdXRTZWxlY3RvciIsInVzZXJQaWN0dXJlU2VsZWN0b3IiLCJ1c2VyTmFtZUVsZW1lbnQiLCJ1c2VyQWJvdXRFbGVtZW50IiwidXNlclBpY3R1cmVFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJhYm91dCIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJzZXRVc2VyUGljdHVyZSIsIl9yZWYzIiwiYXZhdGFyIiwiYXBpIiwib3B0aW9ucyIsIl91cmwiLCJ1cmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfZmV0Y2giLCJ1cGRhdGVVc2VySW5mbyIsImdldEluaXRpYWxDYXJkcyIsImFkZENhcmQiLCJjYXJkSW5mbyIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJ1cGRhdGVVc2VyUGljdHVyZSIsInRoZW4iLCJyZXMiLCJlbmRwb2ludCIsImJvZHkiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJmZXRjaE9wdGlvbnMiLCJtZXRob2QiLCJKU09OIiwic3RyaW5naWZ5IiwiZmV0Y2giLCJfY2hlY2tSZXNwb25zZSIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImF1dGhvcml6YXRpb24iLCJhbGwiLCJ1c2VyRGF0YSIsImluaXRpYWxDYXJkc0FycmF5IiwiY29uZmlybURlbGV0ZUJ0biIsImNhcmRJbnN0YW5jZSIsImNvbmZpcm1EZWxldGVQb3B1cCIsInNldEFjdGlvbiIsImNhcmRJbWFnZSIsImdldEVsZW1lbnRCeUlkIiwiZmlsdGVyIiwiaW1hZ2VMaW5rIiwicmVtb3ZlRnJvbUltYWdlTGlua3NBcnJheSIsImZpbmFsbHkiLCJfY29uZmlybUJ1dHRvbiIsImFjdGlvbiIsImNhcmQiLCJwaWN0dXJlU3VibWl0QnRuIiwiZWRpdFByb2ZpbGVQaWN0dXJlQnRuIiwiZWRpdFByb2ZpbGVQaWN0dXJlRm9ybSIsInByb2ZpbGVGb3JtU3VibWl0QnRuIiwiZWRpdFByb2ZpbGVCdG4iLCJlZGl0UHJvZmlsZUZvcm0iLCJuZXdVc2VyRGF0YSIsImFkZEltYWdlQnRuIiwiaW1hZ2VGb3JtU3VibWl0QnRuIiwiYWRkSW1hZ2VQb3B1cCIsIm5ld0NhcmQiLCJpbWFnZVBvcHVwIiwicG9wdXBJbWFnZSIsImltYWdlUG9wdXBUaXRsZSIsInRleHQiLCJyZXNDYXJkIl0sInNvdXJjZVJvb3QiOiIifQ==